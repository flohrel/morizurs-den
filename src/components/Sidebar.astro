---
import Navigation from '@/components/Navigation.astro';
import Social from '@/components/Social.astro';
import { Icon } from 'astro-icon/components';
---

<header
  class="fixed flex inset-[25px] md:inset-[33px] lg:inset-[41px] xl:inset-[49px] 2xl:inset-[57px] max-md:w-0 md:w-1/3 max-w-96 group-[.sidebar--toggle]/frame-content:max-md:w-[min(33.333%,_15rem)] items-center z-50 [transition:width_500ms_ease-in-out]"
>
  <div
    id="sidebar"
    class="relative h-full w-full group-[.sidebar--toggle]/frame-content:max-md:shadow-sidebar max-md:bg-frame/90 max-md:backdrop-blur-[8px] max-md:[transition:box-shadow_100ms_ease-in-out,background-color_100ms_ease-in-out_500ms] group-[.sidebar--toggle]/frame-content:max-md:[transition:background-color_100ms_ease-in-out_500ms]"
  >
    <div
      class="absolute h-full w-full transition-opacity delay-500 md:opacity-0 max-md:opacity-100 max-md:bg-overlay"
    >
    </div>
    <div
      class="h-full w-full flex flex-col items-left justify-between self-stretch grow overflow-hidden"
    >
      <div
        id="info"
        class="flex flex-col self-stretch p-4 gap-1 md:gap-2 xl:gap-3 sm:p-6 md:p-8 lg:p-10 xl:p-12 2xl:p-14"
      >
        <h1 class="leading-5 whitespace-nowrap">Florian Ohrel</h1>
        <p class="leading-5">Developer</p>
      </div>
      <Navigation />
      <Social />
    </div>
  </div>
  <button
    id="sidebar-toggle-btn"
    class="w-auto h-8 -translate-x-3 inset-[inherit] text-mint hover:text-mintHover z-50 md:x-collapse md:[transition:width_300ms_ease-in-out] max-md:[transition:width_300ms_ease-in-out_500ms,color_100ms_ease-in-out,background_300ms,backdrop-filter_300ms] bg-frame/30 backdrop-blur-[4px]"
  >
    <div
      class="w-6 h-6 md:x-collapse md:[transition:width_300ms_ease-in-out] max-md:[transition:width_300ms_ease-in-out_500ms]"
    >
      <Icon
        name="material-symbols:left-panel-open-sharp"
        title="Open sidebar menu"
        class="group-[.sidebar--toggle]/frame-content:max-md:hidden max-md:block md:hidden w-full h-full"
      />
      <Icon
        name="material-symbols:left-panel-close-sharp"
        title="Close sidebar menu"
        class="group-[.sidebar--toggle]/frame-content:max-md:block hidden w-full h-full"
      />
    </div>
  </button>
</header>

<script>
  const button = document.getElementById('sidebar-toggle-btn');
  const contentFrame = document.getElementById('frame-content');
  const navSelected = document.querySelector(
    'nav ul li.selected .nav__selector'
  );

  button?.addEventListener('click', () => {
    if (contentFrame?.classList.toggle('sidebar--toggle')) {
      navSelected?.classList.add('nav__selector--toggle');
    } else {
      navSelected?.classList.remove('nav__selector--toggle');
    }
  });

  window.addEventListener('resize', () => {
    if (window.matchMedia('(min-width: 768px)').matches) {
      navSelected?.classList.add('nav__selector--toggle');
    } else {
      contentFrame?.classList.remove('sidebar--toggle');
      navSelected?.classList.remove('nav__selector--toggle');
    }
  });
</script>
