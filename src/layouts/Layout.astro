---
import { default as Header } from '@/components/Header/Header.astro';
import Sidebar from '@/components/Header/Sidebar.astro';
import LanguagePicker from '@/components/LanguagePicker.astro';
import Social from '@/components/Social.astro';
import '@fontsource-variable/josefin-sans';
import '@fontsource-variable/josefin-slab';
import { SEO } from 'astro-seo';
import ViewTransitions from 'astro/components/ViewTransitions.astro';
import { getLangFromUrl } from '../i18n/utils';

const lang = getLangFromUrl(Astro.url);

interface Props {
  title: string;
}

const { title } = Astro.props;
---

<!doctype html>
<html lang={lang as string}>
  <head>
    <SEO
      title={title}
      titleTemplate="Florian Ohrel's portfolio - %s"
      description="Florian Ohrel is a full-stack developer based in Paris, France."
      charset="UTF-8"
      openGraph={{
        basic: {
          title: title,
          type: 'website',
          image:
            'https://user-images.githubusercontent.com/5182256/131216951-8f74f425-f775-463d-a11b-0e01ad9fce8d.png',
        },
        optional: {
          description: 'Florian Ohrel is a developer based in Paris, France.',
          locale: 'en_US',
          siteName: "Florian Ohrel's portfolio",
        },
      }}
      extend={{
        link: [{ rel: 'icon', type: 'image/svg+xml', href: '/favicon.ico' }],
        meta: [
          { name: 'generator', content: Astro.generator },
          { name: 'viewport', content: 'width=device-width,initial-scale=1' },
        ],
      }}
    />
    <ViewTransitions />
  </head>
  <body class="h-dvh w-full bg-content text-mint selection:bg-selection">
    <div
      id="overlay"
      class="fixed h-screen w-full inset-0 bg-overlay z-[99] pointer-events-none"
    >
    </div>
    <div
      id="content"
      class="grid grid-cols-12 gap-4 group/content h-screen w-full"
    >
      <Header />
      <Sidebar />
      <main
        class="col-start-2 col-span-10 row-start-1 row-auto z-30 w-full max-w-5xl mt-28 md:mt-32 mx-auto"
      >
        <slot />
        <Social
          className={'max-md:hidden fixed right-0 -bottom-8 flex flex-col gap-4 '}
        />
      </main>
      <LanguagePicker />
    </div>
    <style is:global>
      @tailwind base;
      @tailwind components;

      @layer base {
        *,
        *::before,
        *::after {
          box-sizing: border-box;
          /*border: 1px solid #d7ffff;*/
        }
        a {
          @apply hover:text-mintHover text-mint transition-colors duration-200 ease-in-out;
        }
        button {
          @apply hover:text-mintHover text-mint;
        }
        h1 {
          @apply font-sans font-semibold text-2xl md:text-3xl xl:text-4xl mb-10 text-right flex justify-start;
        }
        h1::after {
          content: '';
          @apply block relative top-5 w-72 h-[1.5px] ml-5 bg-mint/5;
        }
        h2 {
          @apply font-sans font-medium text-lg md:text-xl xl:text-2xl;
        }
        p {
          @apply font-slab font-normal text-base md:text-lg xl:text-xl mb-4 max-w-3xl text-mint/90;
        }
        html {
          scrollbar-width: thin;
          scrollbar-color: #d7ffff40 #0d090f00;
          overflow-y: scroll;
        }
        section {
          @apply mx-auto my-auto min-h-screen scroll-mt-32;
        }
      }

      @layer components {
        .sidebar--toggle {
          a,
          button {
            @apply hover:!text-selection text-frame;
          }
        }
      }
    </style>
    <script>
      document.addEventListener('astro:page-load', () => {
        const content = document.querySelector('#content');
        const sidebarToggleBtn = document.getElementById('sidebar-toggle-btn');

        sidebarToggleBtn?.addEventListener('click', () => {
          content?.classList.toggle('sidebar--toggle');
        });

        window.addEventListener('resize', () => {
          if (!window.matchMedia('(min-width: 768px)').matches) {
            content?.classList.remove('sidebar--toggle');
          }
        });
      });
    </script>
  </body>
</html>
